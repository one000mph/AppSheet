extends ../node_modules/jade-bootstrap/_bootstrap
append styles
	- // Custom styles for this template
	link(href='../sticky-footer-navbar.css', rel='stylesheet')
	link(href='../custom.css', rel='stylesheet')
	title Appsheet Programming Challenge

append scripts
	script(src="//code.jquery.com/jquery-1.11.3.min.js")
	script(src="//cdnjs.cloudflare.com/ajax/libs/jquery.lazyload/1.9.1/jquery.lazyload.js")
	script(src="//ssorallen.com/jquery-scrollstop/jquery.scrollstop.js")
	script.

		var retrieveUrl = function retrieveUrl (id, elClass, callback) {
			$.getJSON('https://appsheettest1.azurewebsites.net/sample/art/' + id, 
			function (data) {
				var url = data.thumbnailUrl;
				var formattedData = "";
				$.each(data, function (key, val) {
					formattedData = formattedData.concat("<b>", key, "</b>: ", val, "<br>");
				});
				$('div.meta'+id).append("<p>" + formattedData + "</p>");
				$(elClass).attr('data-original', url).css("padding", "10px");

				callback();
			});
		};

		var showHideDiv = function showHideDiv(elId) {
			var sliderEl = "div." + elId;
			if ($(sliderEl).hasClass("open")) {
				$(sliderEl).slideUp(200).removeClass("open");
			} else {
				$(sliderEl).slideDown(200).addClass("open");
			}
		};

		var idsArr = '#{ids}'.split(',');

		$.each(idsArr, function (i, id) {
			var imgClass = i + " lazy";
			retrieveUrl(id, '.lazy'+id, function () {
				$('img.lazy'+id).show().lazyload({
					event: "scrollstop",
					threshold : 500
				});
			});
		});

block body
	- // Fixed navbar
	nav.navbar.navbar-default.navbar-fixed-top
		.container
			.navbar-header
				button.navbar-toggle.collapsed(type='button', data-toggle='collapse', data-target='#navbar', aria-expanded='false', aria-controls='navbar')
					span.sr-only Toggle navigation
					span.icon-bar
					span.icon-bar
					span.icon-bar
				a.navbar-brand(href='#') AppSheet
	.container
		.page-header
			h1 Art Gallery
			p.lead
				| Click images for meta data

		- var imageCount = ids.length
		- var imageRows = imageCount/3
		- var row = 0
		- var col = 0
		- var index = 0
		while row < imageRows
			.row
				while col < 3
					.col-md-4
						- var id = ids[index]
						- var imgClass = "artwork lazy" + id
						- var metaClass = "meta meta" + id
						div.art
							a.showMeta(href="javascript:showHideDiv(\"meta"+id+"\")")
								img(class=imgClass)
							div(class=metaClass)
					- col = col + 1
					- index = index + 1
				- col = 0
			- row += 1

			


